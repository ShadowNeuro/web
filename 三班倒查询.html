<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸‰ç­å€’ç­æ¬¡æŸ¥è¯¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
        }
        h1 {
            color: #333;
        }
        .date-selector {
            margin: 20px 0;
        }
        select {
            padding: 8px;
            margin: 5px;
            font-size: 16px;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            background-color: #f0f0f0;
            font-size: 18px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
        }
        .tip {
            margin-top: 30px;
            padding: 10px;
            background-color: #fff9c4;
            border-radius: 5px;
            font-size: 14px;
            display: none; /* é»˜è®¤éšè— */
        }
    </style>
</head>
<body>
    <h1>ä¸‰ç­å€’ç­æ¬¡æŸ¥è¯¢</h1>
    
    <div class="date-selector">
        <label for="year">å¹´ä»½:</label>
        <select id="year"></select>
        
        <label for="month">æœˆä»½:</label>
        <select id="month"></select>
        
        <label for="day">æ—¥æœŸ:</label>
        <select id="day"></select>
        
        <label for="shift-time">æ—¶é—´æ®µ:</label>
        <select id="shift-time">
            <option value="day">ç™½å¤©</option>
            <option value="night">æ™šä¸Š</option>
        </select>
    </div>
    
    <div id="result" class="result"></div>

    <!-- æ·»åŠ æç¤ºæ–‡å­— -->
    <div class="tip">
        æ£€æµ‹åˆ°iPhoneç”¨æˆ·ï¼Œè«ä¸æ˜¯å§“é™ˆçš„ğŸ˜³ğŸ˜³ï¼Œ<span style="color:red;font-size:20px;font-weight:bold;">æ³¨æ„è¿™ä¸ªé“¾æ¥ä¸è¦å‘ç»™åˆ«äººï¼Œå› ä¸ºå‘ç»™ä½ åæ³¨æ„åˆ°è¿™ä¸ªåœ°å€ä¼šæš´éœ²æˆ‘ä¸€äº›éšç§ã€‚ã€‚ã€‚ã€‚</span>ä½†æ˜¯ä¸çŸ¥é“è¿™ä¸ªé“¾æ¥ä½ ä¼šä¸ä¼šç•™ç€ç”¨ï¼Œæ‰€ä»¥å°±å…ˆç•™ç€äº†ï¼Œå¹¶æ²¡æœ‰é”€æ¯ã€‚
        <br />
        <br />
        å¦‚æœè¦åˆ†äº«ç»™åˆ«äººçš„è¯ï¼Œå¯ä»¥å‘é€è¿™ä¸ªé“¾æ¥: <a href="https://gitswno.github.io/web/">https://gitswno.github.io/web/</a>
    </div>

    <script>
        // å¡«å……å¹´ä»½ä¸‹æ‹‰èœå•
        const yearSelect = document.getElementById('year');
        const currentYear = new Date().getFullYear();
        for (let year = currentYear - 5; year <= currentYear + 5; year++) {
            const option = document.createElement('option');
            option.value = year;
            option.textContent = year;
            yearSelect.appendChild(option);
        }
        
        // è®¾ç½®é»˜è®¤å¹´ä»½ä¸ºå½“å‰å¹´
        yearSelect.value = currentYear;
        
        // å¡«å……æœˆä»½ä¸‹æ‹‰èœå•
        const monthSelect = document.getElementById('month');
        for (let month = 1; month <= 12; month++) {
            const option = document.createElement('option');
            option.value = month;
            option.textContent = month;
            monthSelect.appendChild(option);
        }
        
        // è®¾ç½®é»˜è®¤æœˆä»½ä¸ºå½“å‰æœˆ
        monthSelect.value = new Date().getMonth() + 1;
        
        // æ ¹æ®é€‰æ‹©çš„å¹´ä»½å’Œæœˆä»½å¡«å……æ—¥æœŸä¸‹æ‹‰èœå•
        function populateDays() {
            const daySelect = document.getElementById('day');
            daySelect.innerHTML = '';
            
            const year = parseInt(yearSelect.value);
            const month = parseInt(monthSelect.value) - 1; // JavaScriptæœˆä»½ä»0å¼€å§‹
            
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            for (let day = 1; day <= daysInMonth; day++) {
                const option = document.createElement('option');
                option.value = day;
                option.textContent = day;
                daySelect.appendChild(option);
            }
            
            // è®¾ç½®é»˜è®¤æ—¥æœŸä¸ºå½“å‰æ—¥æœŸ
            const currentDate = new Date();
            if (currentDate.getFullYear() === year && currentDate.getMonth() === month) {
                daySelect.value = currentDate.getDate();
            } else {
                daySelect.value = 1;
            }
        }
        
        // å½“å¹´ä»½æˆ–æœˆä»½æ”¹å˜æ—¶ï¼Œæ›´æ–°æ—¥æœŸä¸‹æ‹‰èœå•
        document.getElementById('year').addEventListener('change', populateDays);
        document.getElementById('month').addEventListener('change', populateDays);
        
        // åˆå§‹åŒ–æ—¥æœŸä¸‹æ‹‰èœå•
        populateDays();
        
        // è®¡ç®—ç­æ¬¡
        function calculateShift() {
            const year = parseInt(document.getElementById('year').value);
            const month = parseInt(document.getElementById('month').value);
            const day = parseInt(document.getElementById('day').value);
            const shiftTime = document.getElementById('shift-time').value;
            
            // åˆ›å»ºæ—¥æœŸå¯¹è±¡
            const selectedDate = new Date(year, month - 1, day);
            
            // æ£€æŸ¥æ—¥æœŸæ˜¯å¦æœ‰æ•ˆ
            if (selectedDate.getFullYear() !== year || selectedDate.getMonth() !== month - 1 || selectedDate.getDate() !== day) {
                document.getElementById('result').innerHTML = 'è¯·é€‰æ‹©æœ‰æ•ˆçš„æ—¥æœŸ';
                document.getElementById('result').className = 'result error';
                return;
            }
            
            // è®¾ç½®æ–°çš„åŸºå‡†æ—¥æœŸä¸º2025å¹´3æœˆ18æ—¥
            const baseDate = new Date(2025, 2, 18); // æœˆä»½ä»0å¼€å§‹ï¼Œ3æœˆæ˜¯2
            const timeDiff = selectedDate - baseDate;
            const dayDiff = Math.floor(timeDiff / (1000 * 3600 * 24));
            
            // è®¡ç®—ç­æ¬¡
            let shiftNumber;
            if (shiftTime === 'day') {
                // ç™½å¤©ç­æ¬¡
                shiftNumber = (((dayDiff * 2) % 3) + 3) % 3 + 1;
            } else {
                // æ™šä¸Šç­æ¬¡
                shiftNumber = (((dayDiff * 2 + 1) % 3) + 3) % 3 + 1;
            }
            
            // æ˜¾ç¤ºç»“æœ
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `æ‚¨é€‰æ‹©çš„æ—¥æœŸæ˜¯ ${year}å¹´${month}æœˆ${day}æ—¥ ${shiftTime === 'day' ? 'ç™½å¤©' : 'æ™šä¸Š'}, å¯¹åº”çš„ç­æ¬¡æ˜¯ ${shiftNumber}ç­`;
            resultDiv.className = 'result success';
        }
        
        // ä¸ºæ‰€æœ‰é€‰æ‹©æ¡†æ·»åŠ å˜åŒ–äº‹ä»¶ç›‘å¬å™¨
        document.getElementById('year').addEventListener('change', calculateShift);
        document.getElementById('month').addEventListener('change', calculateShift);
        document.getElementById('day').addEventListener('change', calculateShift);
        document.getElementById('shift-time').addEventListener('change', calculateShift);
        
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è®¡ç®—å½“å¤©çš„ç­æ¬¡
        window.onload = function() {
            calculateShift();
            
            // æ£€æµ‹æ˜¯å¦æ˜¯iPhone
            const isIphone = /iPhone/.test(navigator.userAgent);
            
            // å¦‚æœæ˜¯iPhoneï¼Œæ˜¾ç¤ºæç¤ºæ–‡å­—
            if (isIphone) {
                document.querySelector('.tip').style.display = 'block';
            }
        };
    </script>
</body>
</html>
